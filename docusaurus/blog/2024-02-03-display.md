---
title: 描画の流れ
date: 2024-02-03
tags: [cpp]
---

描画の流れとデータ構造

## Buffer に 行を格納する

第一段階の処理。
URL から http request 、content を parse して 二次元レイアウトして格納する。

:::warning utf-8 のマルチバイト処理必要
:::

loadGeneralFile が起点となる。

```c
Buffer *loadGeneralFile(char *path, ParsedURL *current, char *referer, int flag,
                        FormList *request);
```

## Line 

```c
#define addnewline(a, b, c, d, e, f, g) _addnewline(a, b, c, e, f, g)
void addnewline(Buffer *buf, char *line, Lineprop *prop, Linecolor *color,
                int pos, int width, int nlines);
```

## Buffer を 描画する

第二段階の処理。
Buffer にためこんだ lines を escape sequence で装飾して TERM に出力する。

:::warning utf-8 のマルチバイト処理必要
:::

displayBuffer が起点となる。

